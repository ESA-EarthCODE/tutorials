{"version":2,"kind":"Notebook","sha256":"d9b6ead14b87f1d7743c08e833536fe0ffea0abb9086234ad2a29e741ca70754","slug":"smartch4-signatures-modified","location":"/PRR/smartch4_signatures_modified.ipynb","dependencies":[],"frontmatter":{"title":"SmartCH4 project - Œ¥13CH4 signatures","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"pangeo","language":"python"},"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/ESA-EarthCODE/tutorials","subject":"EarthCODE Tutorials","numbering":{"title":{"offset":1}},"source_url":"https://github.com/ESA-EarthCODE/tutorials/blob/main/PRR/smartch4_signatures_modified.ipynb","edit_url":"https://github.com/ESA-EarthCODE/tutorials/edit/main/PRR/smartch4_signatures_modified.ipynb","exports":[{"format":"ipynb","filename":"smartch4_signatures_modified.ipynb","url":"/tutorials/build/smartch4_signatures_-9a683c9bc511e953627e8dc39694a629.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook shows how to","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n4fXiKCPI1"}],"key":"zZQECgAWxB"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Combine a number of .nc files into a .zarr","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QAP3aVZBr9"}],"key":"YR70yNkI5r"}],"key":"lEUZ5cJUo3"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"generate a valid STAC collection, which is a requirement to upload research outcomes to the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"L3YZngsxiZ"},{"type":"link","url":"https://eoresults.esa.int/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"ESA Project Results Repository (PRR)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Gk6KbgDvp0"}],"urlSource":"https://eoresults.esa.int/","key":"D0zje6RSxD"},{"type":"text","value":". The code below demonstrates how to perform the necessary steps using real data from the ESA project ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UFDBAT0dMy"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"SMART-CH4","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"g4AklqRP8U"}],"key":"v7eFdkeueK"},{"type":"text","value":". The focus of SMART-CH4 is to build upon previous experience and projects in satellite-based methane quantification, aiming to enhance emission products derived from satellites.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OHDSqudjYD"}],"key":"MK0AK7SJYK"}],"key":"c40LxMCusL"}],"key":"hOPqWN8ihD"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Check the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"SKmwsXXyH6"},{"type":"link","url":"https://earthcode.esa.int/","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"EarthCODE documentation","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GxyA5LKEiv"}],"urlSource":"https://earthcode.esa.int/","key":"ADX6TCplXm"},{"type":"text","value":", and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OvygejpDkD"},{"type":"link","url":"https://esa-earthcode.github.io/tutorials/prr-stac-introduction","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"PRR STAC introduction example","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"h1aEDORzH0"}],"urlSource":"https://esa-earthcode.github.io/tutorials/prr-stac-introduction","key":"x2KmjIyfUp"},{"type":"text","value":" for a more general introduction to STAC and the ESA PRR.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vKlB5xaRF8"}],"key":"vMuv6fQv9t"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"üîó Check the project website: ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"iAdSD9pcDC"},{"type":"link","url":"https://smart-ch4.lsce.ipsl.fr/","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"SMART-CH4 ‚Äì Website","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"DX9H5mIRuF"}],"urlSource":"https://smart-ch4.lsce.ipsl.fr/","key":"ETzFM6vlRL"}],"key":"HhfgJXWqyd"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"üîó Check the eo4society page: ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"OkV7ZKxscM"},{"type":"link","url":"https://eo4society.esa.int/projects/smart-ch4/","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"SMART-CH4 ‚Äì eo4society","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"B9o1vUufml"}],"urlSource":"https://eo4society.esa.int/projects/smart-ch4/","key":"IxHGZXIrEW"}],"key":"njJs5CqHK7"},{"type":"heading","depth":4,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Acknowledgment","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"j7QZ74auRl"}],"identifier":"acknowledgment","label":"Acknowledgment","html_id":"acknowledgment","implicit":true,"key":"BoEvOgHRCv"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"We gratefully acknowledge the ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"d0wJQpoWzC"},{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"SMART-CH4","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"dQX90RSQsC"}],"key":"Wp7VLbDbr3"},{"type":"text","value":" for providing access to the data used in this example, as well as their support in creating it.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"quK3YVObuq"}],"key":"JJZCtxTajC"}],"key":"HCMc9Zuqt3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Combine the data into a single .zarr file","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P7FrnltsbJ"}],"identifier":"id-1-combine-the-data-into-a-single-zarr-file","label":"1. Combine the data into a single .zarr file","html_id":"id-1-combine-the-data-into-a-single-zarr-file","implicit":true,"key":"UoHcRcWXL5"}],"key":"E0HDLmlmyl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# import libraries\nimport xarray as xr\nfrom pystac import Item, Collection\nimport pystac\nfrom datetime import datetime\nfrom shapely.geometry import box, mapping\nfrom xstac import xarray_to_stac\nimport glob\nimport json\nimport shapely\nimport numpy as np\nimport geopandas as gpd\nimport pandas as pd\nimport os\nimport scipy","key":"JMBJSzAi61"},{"type":"output","id":"KuakxL8mpR0xBDNwseYgE","data":[],"key":"Z6t0VkDhqy"}],"key":"ptgrNMxOjV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import glob\ndatadir = '/mnt/c/Users/krase/Downloads/smart_CH4_d13c_ch4/5_zipped/data/*'\nsubdirectories = glob.glob(datadir)\nsubdirectories","key":"oU7WovjacS"},{"type":"output","id":"GQlpl4uidrFFy-3JpP3v-","data":[{"output_type":"execute_result","execution_count":245,"metadata":{},"data":{"text/plain":{"content":"['/home/etapin/T√©l√©chargements/5_zipped/data',\n '/home/etapin/T√©l√©chargements/5_zipped/metadata']","content_type":"text/plain"}}}],"key":"gIuyRmYzM9"}],"key":"Xqz2HJ21Xq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"agw_files = glob.glob('/mnt/c/Users/krase/Downloads/smart_CH4_d13c_ch4/5_zipped/data/smart_CH4_d13c_ch4-agw' + '/*')\nbb_files = glob.glob('/mnt/c/Users/krase/Downloads/smart_CH4_d13c_ch4/5_zipped/data/smart_CH4_d13c_ch4-bb' + '/*')\nff_files = glob.glob('/mnt/c/Users/krase/Downloads/smart_CH4_d13c_ch4/5_zipped/data/smart_CH4_d13c_ch4-ff' + '/*')\nnat_files = glob.glob('/mnt/c/Users/krase/Downloads/smart_CH4_d13c_ch4/5_zipped/data/smart_CH4_d13c_ch4-nat' + '/*')\nwet_files = glob.glob('/mnt/c/Users/krase/Downloads/smart_CH4_d13c_ch4/5_zipped/data/smart_CH4_d13c_ch4-wet' + '/*')\n\nshort_names = [\"agw\", \"bb\", \"ffg\", \"nat\", \"wet\"]\nlong_names = [\n    \"agricultural and waste\",\n    \"biomass burning\",\n    \"fossil fuel and geological\",\n    \"natural non-wetland\",\n    \"wetlands\"\n]\n\nsubsector_files = glob.glob('/mnt/c/Users/krase/Downloads/smart_CH4_d13c_ch4/5_zipped/data/smart_CH4_d13c_ch4-subsectors' + '/*')","key":"FNA2NWLEkU"},{"type":"output","id":"vv9vOxgoIJYqGh53spUlM","data":[],"key":"F7Wn3AkC31"}],"key":"pEyC0IRirD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dss = []\n\nfor sname,lname,files in zip(short_names, long_names, [agw_files, bb_files, ff_files, nat_files, wet_files]):\n    print(files)\n    ds = xr.open_mfdataset(\n        files,\n        concat_dim=\"time\",\n        combine=\"nested\",\n        compat=\"equals\",\n        join=\"exact\"\n    )\n    # replace acronym with long name\n    ds.sign_d13c.attrs['long_name'] = ds.sign_d13c.long_name.replace(sname.upper(), lname)\n    # assign all the sigma values to each variable\n    ds.sign_d13c.attrs.update({k:v for k,v in ds.attrs.items() if k.startswith('sigma_')})\n    # rename sign_d13c to have accronym extension\n    ds = ds.rename_vars({'sign_d13c': f'sign_d13c_{sname}'})\n\n    ds.attrs = {\n        \"title\": \"d13C(CH4) isotopic signature\",\n        \"history\": \"Sub-sectors aggregated into sectors (flux-weighted). NaN values filled with flux-weighted global mean.\",\n        \"time_period\": \"Monthly data for 1998-2022\",\n        \"fluxes_source_for_flux_weighted\": \"AGRICULTURAL_WASTE, BIOFUELS, BIOMASS, COAL, LANDFILLS, LIVESTOCK, OILGASIND, RICE, WASTE_WATER: EDGARv8 (Crippa et al. 2023), GEOLOGICAL, OCEANIC, TERMITES, WETLAND: Prior fluxes provided with the Global Methane budget inversion protocol (Martinez et al. 2024)\",\n        \"signature_source\" : \"LIVESTOCK, BIOFUELS, BIOMASS: LAN ET. AL (2021), WASTE_WATER, LANDFILLS, AGRICULTURAL_WASTE, RICE: MENOUD ET AL. (2022), COAL, OILGASIND: LAN ET. AL (2021), MENOUD ET AL. (2022), WETLAND: OH ET AL. (2022), OCEANIC: SANSONE ET AL. (2001), TERMITES: THOMPSON ET AL. (2018), GEOLOGICAL: ETIOPE ET AL. (2019)\",\n        \"created_by\": \"Emeline Tapin on 29 September 2025\",\n        \"creator_email\": \"emeline.tapin@lsce.ipsl.fr\",\n        \"institution\": \"LSCE (Laboratoire des Sciences du Climat et de l‚ÄôEnvironnement)\",\n        \"conventions\": \"CF-1.9\"\n    }\n    \n    dss.append(ds)","key":"mhHtaWHBb0"},{"type":"output","id":"Yt8_XYE0J6qOhaHU_5lDG","data":[{"name":"stdout","output_type":"stream","text":"['/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2022.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2021.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2020.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2002.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2016.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2011.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2017.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2013.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2001.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2008.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2009.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2012.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2000.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.1998.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2006.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2018.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2004.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2005.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2010.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2003.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2007.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2014.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2019.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.1999.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-agw/d13c.AGW.2015.1x1.nc']\n['/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2020.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2016.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2010.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2003.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2019.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2014.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2007.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2021.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2005.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2002.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2000.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2017.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2009.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2008.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2011.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.1999.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2001.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2013.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2004.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2022.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.1998.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2015.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2012.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2006.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-bb/d13c.BB.2018.1x1.nc']\n['/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2004.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2005.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2001.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2015.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2006.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2021.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2009.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2020.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2008.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2014.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2016.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2010.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2019.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.1999.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2017.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2022.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.1998.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2012.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2013.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2003.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2000.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2002.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2018.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2011.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-ff/d13c.FF.2007.1x1.nc']\n['/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2012.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.1998.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2013.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2015.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2008.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2009.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2004.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2001.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2021.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2014.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2016.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2006.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2019.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2018.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2010.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2003.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2000.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2022.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2017.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2007.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.1999.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2011.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2020.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2002.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-nat/d13c.NAT.2005.1x1.nc']\n['/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2015.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2003.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2018.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2000.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2008.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2006.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2010.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2002.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2014.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2022.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2020.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2004.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.1998.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2001.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2021.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2009.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2019.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2011.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.1999.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2007.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2013.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2016.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2005.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2012.1x1.nc', '/home/etapin/T√©l√©chargements/5_zipped/data/smart_CH4_d13c_ch4-wet/d13c.WET.2017.1x1.nc']\n"}],"key":"ih8adufYi6"}],"key":"ueRo4gly5m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds = xr.merge(dss)\nds","key":"DfdzvOU5aq"},{"type":"output","id":"2JhVcsDrMSogfIKrKIJa6","data":[{"output_type":"execute_result","execution_count":248,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"6a28208e08e53fc2a554cb97e956fc36","path":"/tutorials/build/6a28208e08e53fc2a554cb97e956fc36.html"},"text/plain":{"content":"<xarray.Dataset> Size: 778MB\nDimensions:        (latitude: 180, longitude: 360, time: 300)\nCoordinates:\n  * latitude       (latitude) float64 1kB -89.5 -88.5 -87.5 ... 87.5 88.5 89.5\n  * longitude      (longitude) float64 3kB -179.5 -178.5 -177.5 ... 178.5 179.5\n  * time           (time) datetime64[ns] 2kB 1998-01-01 ... 2022-12-01\nData variables:\n    sign_d13c_agw  (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 180, 360), meta=np.ndarray>\n    sign_d13c_bb   (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 180, 360), meta=np.ndarray>\n    sign_d13c_ffg  (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 180, 360), meta=np.ndarray>\n    sign_d13c_nat  (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 180, 360), meta=np.ndarray>\n    sign_d13c_wet  (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 180, 360), meta=np.ndarray>\nAttributes:\n    title:                            d13C(CH4) isotopic signature\n    history:                          Sub-sectors aggregated into sectors (fl...\n    time_period:                      Monthly data for 1998-2022\n    fluxes_source_for_flux_weighted:  AGRICULTURAL_WASTE, BIOFUELS, BIOMASS, ...\n    signature_source:                 LIVESTOCK, BIOFUELS, BIOMASS: LAN ET. A...\n    created_by:                       Emeline Tapin on 29 September 2025\n    creator_email:                    emeline.tapin@lsce.ipsl.fr\n    institution:                      LSCE (Laboratoire des Sciences du Clima...\n    conventions:                      CF-1.9","content_type":"text/plain"}}}],"key":"VgyM7xZGRw"}],"key":"YutUmW58Qi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"### Process subsectors\n\n# Load and process all subsector datasets\nsubsector_datasets = []\n\nfor subsector_file in subsector_files:\n    # Extract filename and subsector name\n    filename = os.path.basename(subsector_file)\n    subsector_name = filename.split('.')[1]\n    print(f\"Processing subsector: {subsector_name}\")\n\n    subsector_ds = xr.open_dataset(\n        subsector_file,\n        chunks={\"time\": 12, \"latitude\": 180, \"longitude\": 360}\n    )\n    # Check and align the time dimension\n    if 'time' in subsector_ds.dims:\n        if len(subsector_ds.time) == 24: # for annual data\n            subsector_ds = subsector_ds.reindex(\n                time=ds.time, method=None, fill_value=np.nan\n            )\n            subsector_ds = subsector_ds.ffill(dim='time')\n\n        else: \n            subsector_ds = subsector_ds.interp(time=ds.time, method='linear')\n    else:\n        # Replicate the data along the main dataset time dimension\n        subsector_ds_list = [subsector_ds for _ in range(len(ds.time))]\n        subsector_ds = xr.concat(subsector_ds_list, dim='time')\n        subsector_ds = subsector_ds.assign_coords(time=ds.time)\n\n    # Reorder dimensions to match (time, latitude, longitude)\n    subsector_ds = subsector_ds.transpose(\"time\", \"latitude\", \"longitude\")\n\n    # Define standardized variable name\n    var_name = f'sign_d13c_sub_sector_{subsector_name}'\n    subsector_ds = subsector_ds.rename({'sign_d13c': var_name})\n\n    # Harmonize variable attributes\n    subsector_ds[var_name].attrs['long_name'] = f\"Monthly Œ¥13C(CH4) isotopic signature for {subsector_name.replace('_', ' ')}\"\n    subsector_ds[var_name].attrs.update({k:v for k,v in subsector_ds.attrs.items() if k.startswith('std_')})\n    subsector_datasets.append(subsector_ds)\n\n# Clean and consistent merge with main dataset\nprint(\"\\nMerging subsector data with main dataset...\")\nfor subsector_ds in subsector_datasets:\n    ds = xr.merge([ds, subsector_ds], compat='override', join='exact')\n    \n# Rechunk all variables to the same chunk size\nds = ds.chunk({\"time\": 12, \"latitude\": 90, \"longitude\": 180})\n\n# Final verification\nprint(f\"\\n Final dataset now contains {len(ds.data_vars)} variables:\")\nfor var in ds.data_vars:\n    v = ds[var]\n    print(f\"  - {var}: {v.dims}, dtype={v.dtype}, chunks={getattr(v.data, 'chunks', None)}\")","key":"tDZKJA7aXp"},{"type":"output","id":"jnUkckdUaxr1wfAbdB3cu","data":[{"name":"stdout","output_type":"stream","text":"Processing subsector: geological\nProcessing subsector: coal\nProcessing subsector: termites\nProcessing subsector: oceanic\nProcessing subsector: rice\nProcessing subsector: landfills\nProcessing subsector: agricultural_waste\nProcessing subsector: livestock\nProcessing subsector: wetlands\nProcessing subsector: biomassbiofuels\nProcessing subsector: waste_water\nProcessing subsector: oilandgas\n\nMerging subsector data with main dataset...\n\n Final dataset now contains 17 variables:\n  - sign_d13c_agw: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_bb: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_ffg: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_nat: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_wet: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_geological: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_coal: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_termites: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_oceanic: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_rice: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_landfills: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_agricultural_waste: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_livestock: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_wetlands: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_biomassbiofuels: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_waste_water: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n  - sign_d13c_sub_sector_oilandgas: ('time', 'latitude', 'longitude'), dtype=float64, chunks=((12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12), (90, 90), (180, 180))\n"}],"key":"gPeSGoPqs9"}],"key":"tPlGniEbJ0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Generate metadata","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oWuydqTzW3"}],"identifier":"id-2-generate-metadata","label":"2. Generate metadata","html_id":"id-2-generate-metadata","implicit":true,"key":"Bkms7SUCQQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The root STAC Collection provides a general description of all project outputs which will be stored on the PRR.\nThe PRR STAC Collection template enforces some required fields that you need to provide in order to build its valid description. Most of these metadata fields should already be available and can be extracted from your data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lfLwT1oqqz"}],"key":"uDoWNVmPN2"}],"key":"cb9n2EmXFn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# create the parent collection\ncollectionid = \"d13c-ch4-signatures-smart-ch4\"\n\n\ncollection = Collection.from_dict(\n    \n{\n  \"type\": \"Collection\",\n  \"id\": collectionid,\n  \"stac_version\": \"1.1.0\",\n  \"title\": \"Global delta-13C(CH4) Source Signatures\",\n  \"description\": \"This dataset provides monthly gridded Œ¥13C(CH‚ÇÑ) isotopic signatures (‚Ä∞ vs V-PDB) for five methane emission sectors: Agricultural & Waste (AGW), Fossil Fuel & Geological (FFG), Biomass Burning (BB), Natural non-wetland (NAT), and Wetlands (WET), and their subsequent sub-sectors, at 1¬∞√ó1¬∞ spatial resolution for the period 1998‚Äì2022. Each sector file contains monthly flux-weighted Œ¥13C(CH‚ÇÑ) signatures computed from prior CH‚ÇÑ emissions used in the Global Methane Budget inversion protocol (Martinez et al., 2024), EDGARv8 (Crippa et al., 2023), and GFED4s (van Wees et al., 2022). Sub-sector Œ¥13C-CH‚ÇÑ source values are derived from recent literature (Lan et al., 2021; Menoud et al., 2022; Oh et al., 2022; Thompson et al., 2018; Etiope et al., 2019; Sansone et al., 2001). The dataset also includes uncertainty components: propagated (œÉprop), aggregation (œÉagg), and total (œÉtotal), expressed in ‚Ä∞ vs V-PDB. Data are suitable for use in atmospheric inversion and isotope modeling frameworks.\",\n  \"extent\": {\n    \"spatial\": {\n      \"bbox\": [\n         [-180, -90, 180, 90]\n      ]\n    },\n    \"temporal\": {\n      \"interval\": [\n        [\n          \"1998-01-01T00:00:00Z\",\n          \"2022-12-31T23:59:59Z\"\n        ]\n      ]\n    }\n  },\n  \"license\": \"CC-BY-4.0\",\n  \"links\": []\n\n}\n\n)\n\ncollection # visualise the metadata of your collection ","key":"Jxi3aS356K"},{"type":"output","id":"ghlwjVXk0fsc976zzA8ho","data":[{"output_type":"execute_result","execution_count":237,"metadata":{},"data":{"text/html":{"content":"\n\n<style>\n.pystac-summary {\n    cursor: pointer;\n    display: list-item;\n    list-style: revert;\n    margin-bottom: 0 !important;\n\n    .pystac-l {\n        padding-left: 0.5em;\n        color: rgb(64, 128, 128);\n        font-style: italic;\n    }\n}\n.pystac-row {\n    overflow-wrap: break-word;\n    padding-left: .825em;\n\n    .pystac-k {\n        display: inline-block;\n        margin: 0px 0.5em 0px 0px;\n    }\n    .pystac-v {\n        color: rgb(186, 33, 33);\n    }\n}\n.pystac-k {\n    color: rgb(0, 128, 0);\n    font-weight: 700;\n}\n.pystac-wrap {\n  display: block !important;\n}\n.pystac-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n</style>\n<div>\n<div class=\"pystac-text-repr-fallback\">\n    &lt;Collection id=d13c-ch4-signatures-smart-ch4&gt;\n</div>\n<div class=\"jp-RenderedJSON jp-mod-trusted jp-OutputArea-output pystac-wrap\" style='display:none'>\n    <div class=\"container\" style=\"line-height: normal;\">\n        <ul style=\"padding: 0px; margin: 0px; list-style: none; display: block;\">\n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"Collection\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">id</span>\n            <span class=\"pystac-v\">\"d13c-ch4-signatures-smart-ch4\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">stac_version</span>\n            <span class=\"pystac-v\">\"1.1.0\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">description</span>\n            <span class=\"pystac-v\">\"This dataset provides monthly gridded Œ¥13C(CH‚ÇÑ) isotopic signatures (‚Ä∞ vs V-PDB) for five methane emission sectors: Agricultural & Waste (AGW), Fossil Fuel & Geological (FFG), Biomass Burning (BB), Natural non-wetland (NAT), and Wetlands (WET), and their subsequent sub-sectors, at 1¬∞√ó1¬∞ spatial resolution for the period 1998‚Äì2022. Each sector file contains monthly flux-weighted Œ¥13C(CH‚ÇÑ) signatures computed from prior CH‚ÇÑ emissions used in the Global Methane Budget inversion protocol (Martinez et al., 2024), EDGARv8 (Crippa et al., 2023), and GFED4s (van Wees et al., 2022). Sub-sector Œ¥13C-CH‚ÇÑ source values are derived from recent literature (Lan et al., 2021; Menoud et al., 2022; Oh et al., 2022; Thompson et al., 2018; Etiope et al., 2019; Sansone et al., 2001). The dataset also includes uncertainty components: propagated (œÉprop), aggregation (œÉagg), and total (œÉtotal), expressed in ‚Ä∞ vs V-PDB. Data are suitable for use in atmospheric inversion and isotope modeling frameworks.\"</span>\n        </li>\n    \n                \n            \n                \n                    <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">links</span><span class=\"pystac-l\">[] 0 items</span></summary>\n        \n    </details></li>\n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">title</span>\n            <span class=\"pystac-v\">\"Global delta-13C(CH4) Source Signatures\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">extent</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">spatial</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">bbox</span><span class=\"pystac-l\">[] 1 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span><span class=\"pystac-l\">[] 4 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">0</span>\n            <span class=\"pystac-v\">-180</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">1</span>\n            <span class=\"pystac-v\">-90</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">2</span>\n            <span class=\"pystac-v\">180</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">3</span>\n            <span class=\"pystac-v\">90</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">temporal</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">interval</span><span class=\"pystac-l\">[] 1 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span><span class=\"pystac-l\">[] 2 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">0</span>\n            <span class=\"pystac-v\">\"1998-01-01T00:00:00Z\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">1</span>\n            <span class=\"pystac-v\">\"2022-12-31T23:59:59Z\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n    </ul>\n        </details></li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">license</span>\n            <span class=\"pystac-v\">\"CC-BY-4.0\"</span>\n        </li>\n    \n                \n            \n        </ul>\n    </div>\n</div>\n</div>","content_type":"text/html"},"text/plain":{"content":"<Collection id=d13c-ch4-signatures-smart-ch4>","content_type":"text/plain"}}}],"key":"IkeKZj9ZqG"}],"key":"aqIfnZHtAe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create STAC Items and STAC Assets from original dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YHipCYU5JB"}],"identifier":"create-stac-items-and-stac-assets-from-original-dataset","label":"Create STAC Items and STAC Assets from original dataset","html_id":"create-stac-items-and-stac-assets-from-original-dataset","implicit":true,"key":"Z2xvNemcyg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The second step is to describe the different files as STAC Items and Assets. Take your time to decide how your data should be categorised to improve usability of the data, and ensure intuitive navigation through different items in the collections. There are multiple strategies for doing this and this tutorial demonstrate one of the possible ways of doing that. Examples of how other ESA projects are doing this are available in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NlYkZ5hDmz"},{"type":"link","url":"https://esa-earthcode.github.io/tutorials/prr-stac-introduction","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"EarthCODE documentation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"F48M1d7PhZ"}],"urlSource":"https://esa-earthcode.github.io/tutorials/prr-stac-introduction","key":"utKJz65oE0"},{"type":"text","value":" .","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e1uVD3yCLp"}],"key":"e7R7OTo82a"}],"key":"IOTfDXrt9F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bbox = [-180, -90, 180, 90]\ngeometry = json.loads(json.dumps(shapely.box(*bbox).__geo_interface__))","key":"LBwgfyfaJ0"},{"type":"output","id":"sbqlIYE5myR2ktAU8jojz","data":[],"key":"so1cKuak9l"}],"key":"CIlSpQsPAl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"template = {\n\n    \"id\": f\"{collectionid}-zarr\",\n    \"type\": \"Feature\",\n    \"stac_version\": \"1.0.0\",\n    \"properties\": {\n        \"title\": 'd13C(CH4) isotopic signatures',\n        \"history\":ds.attrs['history'],\n        'time_period': \"Monthly data from 1998 to 2022\",\n        \"fluxes_source_for_flux_weighted\": ds.attrs['fluxes_source_for_flux_weighted'],\n        \"signature_source\": ds.attrs['signature_source'],\n        \"start_datetime\": \"1998-01-01T00:00:00Z\",\n        \"end_datetime\": \"2022-12-31T23:59:59Z\",\n        \"license\": \"CC-BY-4.0\",\n        'Conventions': 'CF-1.9',\n        \"references\": [\n      \"Lan et al. (2021)\",\n      \"Menoud et al. (2022)\",\n      \"Oh et al. (2022)\",\n      \"Thompson et al. (2018)\",\n      \"Etiope et al. (2019)\",\n      \"Sansone et al. (2001)\",\n      \"Crippa et al. (2023)\",\n      \"Martinez et al. (2024)\"\n    ],\n    },\n    \"geometry\": geometry,\n    \"bbox\": bbox,\n    \"assets\": {\n        \"data\": {\n            \"href\": f\"./{collectionid}/ds.zarr\",  # or local path\n            \"type\": \"application/vnd+zarr\",\n            \"roles\": [\"data\"],\n            \"title\": \"Zarr Store of d13C(CH4) signatures\"\n        }\n    }\n}\n# 3. Generate the STAC Item\nitem = xarray_to_stac(\n    ds,\n    template,\n    temporal_dimension=\"time\" if 'time' in ds.coords else False,\n    x_dimension='longitude',\n    y_dimension='latitude',\n    reference_system=False\n)\n\n# validate and add the STAC Item to the collection\nitem.validate()\ncollection.add_item(item)","key":"KewNxQQZ63"},{"type":"output","id":"_FKXiGIxgcDeC2VrSWnTy","data":[{"output_type":"execute_result","execution_count":239,"metadata":{},"data":{"text/html":{"content":"\n\n<style>\n.pystac-summary {\n    cursor: pointer;\n    display: list-item;\n    list-style: revert;\n    margin-bottom: 0 !important;\n\n    .pystac-l {\n        padding-left: 0.5em;\n        color: rgb(64, 128, 128);\n        font-style: italic;\n    }\n}\n.pystac-row {\n    overflow-wrap: break-word;\n    padding-left: .825em;\n\n    .pystac-k {\n        display: inline-block;\n        margin: 0px 0.5em 0px 0px;\n    }\n    .pystac-v {\n        color: rgb(186, 33, 33);\n    }\n}\n.pystac-k {\n    color: rgb(0, 128, 0);\n    font-weight: 700;\n}\n.pystac-wrap {\n  display: block !important;\n}\n.pystac-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n</style>\n<div>\n<div class=\"pystac-text-repr-fallback\">\n    &lt;Link rel=item target=&lt;Item id=d13c-ch4-signatures-smart-ch4-zarr&gt;&gt;\n</div>\n<div class=\"jp-RenderedJSON jp-mod-trusted jp-OutputArea-output pystac-wrap\" style='display:none'>\n    <div class=\"container\" style=\"line-height: normal;\">\n        <ul style=\"padding: 0px; margin: 0px; list-style: none; display: block;\">\n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">rel</span>\n            <span class=\"pystac-v\">\"item\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">href</span>\n            <span class=\"pystac-v\">None</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"application/geo+json\"</span>\n        </li>\n    \n                \n            \n        </ul>\n    </div>\n</div>\n</div>","content_type":"text/html"},"text/plain":{"content":"<Link rel=item target=<Item id=d13c-ch4-signatures-smart-ch4-zarr>>","content_type":"text/plain"}}}],"key":"u3K4VqXV8L"}],"key":"DgosQM7qhY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"collection","key":"grCYiQ1mYR"},{"type":"output","id":"34BXNeCrcnC9bWF1RwwsG","data":[{"output_type":"execute_result","execution_count":240,"metadata":{},"data":{"text/html":{"content":"\n\n<style>\n.pystac-summary {\n    cursor: pointer;\n    display: list-item;\n    list-style: revert;\n    margin-bottom: 0 !important;\n\n    .pystac-l {\n        padding-left: 0.5em;\n        color: rgb(64, 128, 128);\n        font-style: italic;\n    }\n}\n.pystac-row {\n    overflow-wrap: break-word;\n    padding-left: .825em;\n\n    .pystac-k {\n        display: inline-block;\n        margin: 0px 0.5em 0px 0px;\n    }\n    .pystac-v {\n        color: rgb(186, 33, 33);\n    }\n}\n.pystac-k {\n    color: rgb(0, 128, 0);\n    font-weight: 700;\n}\n.pystac-wrap {\n  display: block !important;\n}\n.pystac-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n</style>\n<div>\n<div class=\"pystac-text-repr-fallback\">\n    &lt;Collection id=d13c-ch4-signatures-smart-ch4&gt;\n</div>\n<div class=\"jp-RenderedJSON jp-mod-trusted jp-OutputArea-output pystac-wrap\" style='display:none'>\n    <div class=\"container\" style=\"line-height: normal;\">\n        <ul style=\"padding: 0px; margin: 0px; list-style: none; display: block;\">\n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"Collection\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">id</span>\n            <span class=\"pystac-v\">\"d13c-ch4-signatures-smart-ch4\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">stac_version</span>\n            <span class=\"pystac-v\">\"1.1.0\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">description</span>\n            <span class=\"pystac-v\">\"This dataset provides monthly gridded Œ¥13C(CH‚ÇÑ) isotopic signatures (‚Ä∞ vs V-PDB) for five methane emission sectors: Agricultural & Waste (AGW), Fossil Fuel & Geological (FFG), Biomass Burning (BB), Natural non-wetland (NAT), and Wetlands (WET), and their subsequent sub-sectors, at 1¬∞√ó1¬∞ spatial resolution for the period 1998‚Äì2022. Each sector file contains monthly flux-weighted Œ¥13C(CH‚ÇÑ) signatures computed from prior CH‚ÇÑ emissions used in the Global Methane Budget inversion protocol (Martinez et al., 2024), EDGARv8 (Crippa et al., 2023), and GFED4s (van Wees et al., 2022). Sub-sector Œ¥13C-CH‚ÇÑ source values are derived from recent literature (Lan et al., 2021; Menoud et al., 2022; Oh et al., 2022; Thompson et al., 2018; Etiope et al., 2019; Sansone et al., 2001). The dataset also includes uncertainty components: propagated (œÉprop), aggregation (œÉagg), and total (œÉtotal), expressed in ‚Ä∞ vs V-PDB. Data are suitable for use in atmospheric inversion and isotope modeling frameworks.\"</span>\n        </li>\n    \n                \n            \n                \n                    <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">links</span><span class=\"pystac-l\">[] 1 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">rel</span>\n            <span class=\"pystac-v\">\"item\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">href</span>\n            <span class=\"pystac-v\">None</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"application/geo+json\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">title</span>\n            <span class=\"pystac-v\">\"Global delta-13C(CH4) Source Signatures\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">extent</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">spatial</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">bbox</span><span class=\"pystac-l\">[] 1 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span><span class=\"pystac-l\">[] 4 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">0</span>\n            <span class=\"pystac-v\">-180</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">1</span>\n            <span class=\"pystac-v\">-90</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">2</span>\n            <span class=\"pystac-v\">180</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">3</span>\n            <span class=\"pystac-v\">90</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">temporal</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">interval</span><span class=\"pystac-l\">[] 1 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span><span class=\"pystac-l\">[] 2 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">0</span>\n            <span class=\"pystac-v\">\"1998-01-01T00:00:00Z\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">1</span>\n            <span class=\"pystac-v\">\"2022-12-31T23:59:59Z\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n    </ul>\n        </details></li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">license</span>\n            <span class=\"pystac-v\">\"CC-BY-4.0\"</span>\n        </li>\n    \n                \n            \n        </ul>\n    </div>\n</div>\n</div>","content_type":"text/html"},"text/plain":{"content":"<Collection id=d13c-ch4-signatures-smart-ch4>","content_type":"text/plain"}}}],"key":"dDru4uGTkY"}],"key":"zSgyI639g5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"item","key":"HhzbRH7mdd"},{"type":"output","id":"3pnytwxCl9DCq2kpR1wA8","data":[{"output_type":"execute_result","execution_count":241,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"c6af4fa2aca50df75d8376f9f10c32d7","path":"/tutorials/build/c6af4fa2aca50df75d8376f9f10c32d7.html"},"text/plain":{"content":"<Item id=d13c-ch4-signatures-smart-ch4-zarr>","content_type":"text/plain"}}}],"key":"XoGqNzUp0U"}],"key":"yStei0O1Ep"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds","key":"fnHpqfckbi"},{"type":"output","id":"YQIk-CR8oL71ALqTZy2-i","data":[{"output_type":"execute_result","execution_count":242,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"9f75b02c5fca82592c709d85305c3388","path":"/tutorials/build/9f75b02c5fca82592c709d85305c3388.html"},"text/plain":{"content":"<xarray.Dataset> Size: 3GB\nDimensions:                                  (latitude: 180, longitude: 360,\n                                              time: 300)\nCoordinates:\n  * latitude                                 (latitude) float64 1kB -89.5 ......\n  * longitude                                (longitude) float64 3kB -179.5 ....\n  * time                                     (time) datetime64[ns] 2kB 1998-0...\nData variables: (12/17)\n    sign_d13c_agw                            (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_bb                             (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_ffg                            (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_nat                            (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_wet                            (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_sub_sector_geological          (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    ...                                       ...\n    sign_d13c_sub_sector_agricultural_waste  (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_sub_sector_livestock           (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_sub_sector_wetlands            (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_sub_sector_biomassbiofuels     (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_sub_sector_waste_water         (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\n    sign_d13c_sub_sector_oilandgas           (time, latitude, longitude) float64 156MB dask.array<chunksize=(12, 90, 180), meta=np.ndarray>\nAttributes:\n    title:                            d13C(CH4) isotopic signature\n    history:                          Sub-sectors aggregated into sectors (fl...\n    time_period:                      Monthly data for 1998-2022\n    fluxes_source_for_flux_weighted:  AGRICULTURAL_WASTE, BIOFUELS, BIOMASS, ...\n    signature_source:                 LIVESTOCK, BIOFUELS, BIOMASS: LAN ET. A...\n    created_by:                       Emeline Tapin on 29 September 2025\n    creator_email:                    emeline.tapin@lsce.ipsl.fr\n    institution:                      LSCE (Laboratoire des Sciences du Clima...\n    conventions:                      CF-1.9","content_type":"text/plain"}}}],"key":"NypWPBvNvW"}],"key":"tYBu7ckU3P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# save the full self-contained collection\ncollection.normalize_and_save(\n    root_href=f'../../prr_preview/{collectionid}',\n    catalog_type=pystac.CatalogType.SELF_CONTAINED\n)","key":"j4p3Y2XCfm"},{"type":"output","id":"tZYCAUgTwWiXKhBGRYVf7","data":[],"key":"dXh7xM0DaH"}],"key":"phuE4xhGx1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"collection","key":"A7MaQBaAj2"},{"type":"output","id":"ccpwOqJ24pSxtRp_zP7Jf","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/html":{"content":"\n\n<style>\n.pystac-summary {\n    cursor: pointer;\n    display: list-item;\n    list-style: revert;\n    margin-bottom: 0 !important;\n\n    .pystac-l {\n        padding-left: 0.5em;\n        color: rgb(64, 128, 128);\n        font-style: italic;\n    }\n}\n.pystac-row {\n    overflow-wrap: break-word;\n    padding-left: .825em;\n\n    .pystac-k {\n        display: inline-block;\n        margin: 0px 0.5em 0px 0px;\n    }\n    .pystac-v {\n        color: rgb(186, 33, 33);\n    }\n}\n.pystac-k {\n    color: rgb(0, 128, 0);\n    font-weight: 700;\n}\n.pystac-wrap {\n  display: block !important;\n}\n.pystac-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n</style>\n<div>\n<div class=\"pystac-text-repr-fallback\">\n    &lt;Collection id=d13c-ch4-signatures-smart-ch4&gt;\n</div>\n<div class=\"jp-RenderedJSON jp-mod-trusted jp-OutputArea-output pystac-wrap\" style='display:none'>\n    <div class=\"container\" style=\"line-height: normal;\">\n        <ul style=\"padding: 0px; margin: 0px; list-style: none; display: block;\">\n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"Collection\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">id</span>\n            <span class=\"pystac-v\">\"d13c-ch4-signatures-smart-ch4\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">stac_version</span>\n            <span class=\"pystac-v\">\"1.1.0\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">description</span>\n            <span class=\"pystac-v\">\"This dataset provides monthly gridded Œ¥13C(CH‚ÇÑ) isotopic signatures (‚Ä∞ vs V-PDB) for five methane emission sectors: Agricultural & Waste (AGW), Fossil Fuel & Geological (FFG), Biomass Burning (BB), Natural non-wetland (NAT), and Wetlands (WET), and their subsequent sub-sectors, at 1¬∞√ó1¬∞ spatial resolution for the period 1998‚Äì2022. Each sector file contains monthly flux-weighted Œ¥13C(CH‚ÇÑ) signatures computed from prior CH‚ÇÑ emissions used in the Global Methane Budget inversion protocol (Martinez et al., 2024), EDGARv8 (Crippa et al., 2023), and GFED4s (van Wees et al., 2022). Sub-sector Œ¥13C-CH‚ÇÑ source values are derived from recent literature (Lan et al., 2021; Menoud et al., 2022; Oh et al., 2022; Thompson et al., 2018; Etiope et al., 2019; Sansone et al., 2001). The dataset also includes uncertainty components: propagated (œÉprop), aggregation (œÉagg), and total (œÉtotal), expressed in ‚Ä∞ vs V-PDB. Data are suitable for use in atmospheric inversion and isotope modeling frameworks.\"</span>\n        </li>\n    \n                \n            \n                \n                    <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">links</span><span class=\"pystac-l\">[] 3 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">rel</span>\n            <span class=\"pystac-v\">\"root\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">href</span>\n            <span class=\"pystac-v\">\"/home/etapin/T√©l√©chargements/collection.json\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"application/json\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">title</span>\n            <span class=\"pystac-v\">\"Global delta-13C(CH4) Source Signatures\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">1</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">rel</span>\n            <span class=\"pystac-v\">\"item\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">href</span>\n            <span class=\"pystac-v\">\"/home/etapin/T√©l√©chargements/d13c-ch4-signatures-smart-ch4-zarr/d13c-ch4-signatures-smart-ch4-zarr.json\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"application/geo+json\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">2</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">rel</span>\n            <span class=\"pystac-v\">\"self\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">href</span>\n            <span class=\"pystac-v\">\"/home/etapin/T√©l√©chargements/collection.json\"</span>\n        </li>\n    \n            \n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">type</span>\n            <span class=\"pystac-v\">\"application/json\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">title</span>\n            <span class=\"pystac-v\">\"Global delta-13C(CH4) Source Signatures\"</span>\n        </li>\n    \n                \n            \n                \n                    \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">extent</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">spatial</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">bbox</span><span class=\"pystac-l\">[] 1 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span><span class=\"pystac-l\">[] 4 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">0</span>\n            <span class=\"pystac-v\">-180</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">1</span>\n            <span class=\"pystac-v\">-90</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">2</span>\n            <span class=\"pystac-v\">180</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">3</span>\n            <span class=\"pystac-v\">90</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n            \n                \n        <li><details>\n            <summary class=\"pystac-summary\"><span class=\"pystac-k\">temporal</span></summary>\n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">interval</span><span class=\"pystac-l\">[] 1 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                <li><details>\n        <summary class=\"pystac-summary\"><span class=\"pystac-k\">0</span><span class=\"pystac-l\">[] 2 items</span></summary>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">0</span>\n            <span class=\"pystac-v\">\"1998-01-01T00:00:00Z\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n            <ul style=\"margin: 0px; padding: 0px 0px 0px 1.75em; list-style: none; display: block;\">\n        \n            \n                \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">1</span>\n            <span class=\"pystac-v\">\"2022-12-31T23:59:59Z\"</span>\n        </li>\n    \n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        \n    </details></li>\n            \n        \n    </ul>\n        </details></li>\n    \n            \n        \n    </ul>\n        </details></li>\n    \n                \n            \n                \n                    \n        <li class=\"pystac-row\">\n            <span class=\"pystac-k\">license</span>\n            <span class=\"pystac-v\">\"CC-BY-4.0\"</span>\n        </li>\n    \n                \n            \n        </ul>\n    </div>\n</div>\n</div>","content_type":"text/html"},"text/plain":{"content":"<Collection id=d13c-ch4-signatures-smart-ch4>","content_type":"text/plain"}}}],"key":"ZXAHrm4yHC"}],"key":"usQ3bSWGWG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# verify data is correctly aligned","key":"saJNwbUwAU"},{"type":"output","id":"-swQq2I66XDeTXru6Yh5P","data":[],"key":"LXBBLABVt0"}],"key":"O45FFYWLO2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"assert np.isclose(\n    #original data\n    xr.open_dataset(ff_files[3]).sign_d13c.sel(time='2001-05-01').values,\n    # data from the zarr store\n    ds.sign_d13c_ffg.sel(time='2001-05-01').values\n).all()","key":"mLZWJkCQeW"},{"type":"output","id":"DJFJD3zgQkZ_XZOPolT7m","data":[],"key":"P8e30hrydC"}],"key":"WxGYpISO1t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds.to_zarr('../../data/d13c-ch4-signatures-smart-ch4.zarr', mode='w')","key":"YjZ3SV03xZ"},{"type":"output","id":"zlUdm3VmH0CMMKRxAQqAj","data":[],"key":"kYaulBQeY6"}],"key":"R9a5D03gRA"}],"key":"N9nuoCL6ys"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Generating STAC metadata for the OHC 4d Atlantic dataset","url":"/prr-stac-introduction","group":"EarthCODE Tutorials"},"next":{"title":"Generating STAC metadata for the YIPEEO project","url":"/prr-zarr","group":"EarthCODE Tutorials"}}},"domain":"http://localhost:3000"}